<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liquid Glass OS Concept</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #030303;
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            color: white;
            perspective: 1200px;
        }

        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .os-interface {
            position: relative;
            z-index: 10;
            height: 100vh;
            display: flex;
            flex-direction: column;
            pointer-events: none;
        }

        /* Hyprland-style Bouncy Glass UI */
        .glass-panel {
            pointer-events: auto;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(25px) saturate(180%);
            -webkit-backdrop-filter: blur(25px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            transition: transform 0.15s ease-out, flex 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* Top Navigation & Tabs */
        .browser-chrome {
            padding: 0.5rem 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .tabs-container {
            display: flex;
            gap: 4px;
            padding: 0 10px;
            overflow-x: auto;
        }
        .tabs-container::-webkit-scrollbar { display: none; }

        .tab {
            padding: 6px 16px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px 12px 0 0;
            font-size: 0.75rem;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom: none;
            transition: all 0.2s ease;
            min-width: 140px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            white-space: nowrap;
        }

        .tab:hover { background: rgba(255, 255, 255, 0.1); }
        .tab.active {
            background: rgba(255, 255, 255, 0.15);
            border-top: 2px solid rgba(255, 255, 255, 0.6);
            font-weight: 600;
        }

        .close-btn { opacity: 0.4; transition: opacity 0.2s; padding: 2px 6px; border-radius: 4px; }
        .close-btn:hover { opacity: 1; background: rgba(255, 0, 0, 0.5); }

        .address-bar {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 99px;
            padding: 8px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: border-color 0.2s, background 0.2s;
        }
        .address-bar:focus-within {
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(0, 0, 0, 0.5);
        }
        .address-input {
            background: transparent;
            border: none;
            outline: none;
            color: white;
            font-size: 0.85rem;
            width: 100%;
            font-family: inherit;
        }

        /* Dynamic Tiling Layout */
        .viewport {
            flex-grow: 1;
            padding: 1.5rem;
            display: flex;
            gap: 1.5rem;
            height: calc(100vh - 180px); /* Leave room for header/footer */
            overflow-x: auto;
            align-items: stretch;
        }
        .viewport::-webkit-scrollbar { display: none; }

        .app-window {
            border-radius: 24px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            flex-shrink: 0;
        }

        /* Specific App Sizing */
        #browser-app { flex: 1 1 500px; min-width: 400px; }
        #editor-app { flex: 1 1 400px; min-width: 300px; }
        #phone-app { flex: 0 0 340px; border-radius: 40px; } /* Phone Shape */
        #settings-app { flex: 0 0 320px; }

        /* Taskbar Icons */
        .taskbar {
            pointer-events: auto;
            align-self: center;
            margin-bottom: 1.5rem;
            padding: 10px 20px;
            border-radius: 24px;
            display: flex;
            gap: 15px;
            backdrop-filter: blur(30px) saturate(200%);
        }

        .app-icon {
            width: 44px;
            height: 44px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            color: rgba(255,255,255,0.7);
        }
        .app-icon.active {
            background: rgba(255, 255, 255, 0.2);
            border-bottom: 3px solid white;
            color: white;
        }
        .app-icon:hover {
            transform: scale(1.2) translateY(-10px);
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 10px 20px rgba(0,0,0,0.4);
            color: white;
        }

        .blob {
            position: absolute;
            width: 40vw;
            height: 40vw;
            filter: blur(120px);
            border-radius: 50%;
            z-index: 0;
            opacity: 0.3;
            pointer-events: none;
            transition: background 1s ease;
        }

        #browser-frame {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
            border-radius: 0 0 24px 24px;
            display: none;
        }

        /* Mock Social Feed (TikTok Style) */
        .social-feed {
            scroll-snap-type: y mandatory;
            overflow-y: scroll;
            scrollbar-width: none; /* Firefox */
        }
        .social-feed::-webkit-scrollbar { display: none; }
        .social-video {
            scroll-snap-align: start;
            height: 100%;
            width: 100%;
            position: relative;
            background-size: cover;
            background-position: center;
        }
        .notch {
            position: absolute;
            top: 0; left: 50%;
            transform: translateX(-50%);
            width: 120px; height: 25px;
            background: black;
            border-radius: 0 0 16px 16px;
            z-index: 50;
        }

        /* Command Toast */
        #cmd-toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 100;
        }
        #cmd-toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
    </style>
</head>
<body>

    <!-- Background WebGL Blobs -->
    <div class="blob" id="blob1" style="top: -10%; left: 10%; background: #6366f1;"></div>
    <div class="blob" id="blob2" style="bottom: -10%; right: 10%; background: #ec4899;"></div>

    <div id="canvas-container">
        <canvas id="glCanvas"></canvas>
    </div>

    <!-- Command Toast Notification -->
    <div id="cmd-toast" class="glass-panel px-6 py-3 rounded-full text-sm font-bold tracking-widest flex items-center gap-3">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 3a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3H6a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3V6a3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 3 3 0 0 0-3-3z"></path></svg>
        <span id="cmd-text">COMMAND EXECUTED</span>
    </div>

    <div class="os-interface">
        
        <!-- Main Desktop Area -->
        <main class="viewport" id="viewport">
            
            <!-- 1. BROWSER APP -->
            <div class="glass-panel app-window interactive-element" id="browser-app">
                <header class="browser-chrome bg-black/20 border-b border-white/10">
                    <div class="tabs-container" id="tab-bar"></div>
                    <div class="address-bar">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        <input type="text" id="url-input" class="address-input" value="liquid://home" placeholder="Enter URL or search term..." autocomplete="off">
                    </div>
                </header>
                <div id="home-screen" class="p-6 h-full flex flex-col relative">
                    <h2 class="text-3xl font-bold mb-4 tracking-tight">System Refraction</h2>
                    <div class="flex-grow rounded-xl bg-white/5 border border-white/5 p-8 flex flex-col items-center justify-center text-center">
                        <div class="text-6xl font-black mb-2 opacity-20">GLASS.OS</div>
                        <p class="text-sm text-indigo-300 uppercase tracking-widest font-bold mb-8">Concept v4.0 // Perfected Layout</p>
                        <div class="grid grid-cols-2 gap-4 max-w-md w-full">
                            <button onclick="loadUrl('https://en.wikipedia.org')" class="p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition-colors">
                                <div class="font-bold">Wikipedia</div>
                                <div class="text-xs opacity-50">Free Encyclopedia</div>
                            </button>
                            <button onclick="loadUrl('https://saskatoon.ca')" class="p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition-colors">
                                <div class="font-bold">Saskatoon</div>
                                <div class="text-xs opacity-50">City Portal</div>
                            </button>
                        </div>
                    </div>
                </div>
                <iframe id="browser-frame" sandbox="allow-same-origin allow-scripts allow-popups allow-forms"></iframe>
            </div>

            <!-- 2. TEXT EDITOR APP -->
            <div id="editor-app" class="glass-panel app-window interactive-element hidden">
                <div class="flex justify-between items-center p-3 border-b border-white/10 bg-black/20">
                    <div class="text-xs font-bold tracking-widest text-indigo-300 flex items-center gap-2">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>
                        LIQUID_EDIT
                    </div>
                    <button onclick="toggleApp('editor')" class="text-white/50 hover:text-white px-2 rounded hover:bg-white/10 transition-colors text-lg leading-none">&times;</button>
                </div>
                <textarea class="flex-grow w-full bg-transparent text-white p-4 outline-none resize-none font-mono text-sm leading-relaxed" spellcheck="false" placeholder="// Write your code here...&#10;&#10;function bounce() {&#10;  console.log('Hyprland style tiling!');&#10;}"></textarea>
            </div>

            <!-- 3. PHONE / SOCIAL APP -->
            <div id="phone-app" class="glass-panel app-window interactive-element hidden relative border-[4px] border-white/20">
                <div class="notch"></div>
                <div class="social-feed h-full w-full">
                    <!-- Video 1 -->
                    <div class="social-video flex items-end p-4 pb-20" style="background: linear-gradient(to top, rgba(0,0,0,0.8), transparent), url('https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?q=80&w=800&auto=format&fit=crop'); background-size: cover;">
                        <div class="flex justify-between w-full items-end z-10">
                            <div class="max-w-[70%]">
                                <h4 class="font-bold text-lg">@LiquidConcept</h4>
                                <p class="text-sm opacity-90">Testing the new Hyprland physics on this browser OS. üåä‚ú® #tech #design</p>
                            </div>
                            <div class="flex flex-col gap-4 items-center">
                                <button class="p-3 bg-white/10 rounded-full backdrop-blur hover:bg-white/20"><svg width="24" height="24" viewBox="0 0 24 24" fill="white" stroke="none"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg></button>
                                <span class="text-xs font-bold">124K</span>
                                <button class="p-3 bg-white/10 rounded-full backdrop-blur hover:bg-white/20"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg></button>
                                <span class="text-xs font-bold">1,042</span>
                            </div>
                        </div>
                    </div>
                    <!-- Video 2 -->
                    <div class="social-video flex items-end p-4 pb-20" style="background: linear-gradient(to top, rgba(0,0,0,0.8), transparent), url('https://images.unsplash.com/photo-1550745165-9bc0b252726f?q=80&w=800&auto=format&fit=crop'); background-size: cover;">
                        <div class="flex justify-between w-full items-end z-10">
                            <div class="max-w-[70%]">
                                <h4 class="font-bold text-lg">@RetroCyber</h4>
                                <p class="text-sm opacity-90">Just vibing in the digital realm. üïπÔ∏è</p>
                            </div>
                            <div class="flex flex-col gap-4 items-center">
                                <button class="p-3 bg-white/10 rounded-full backdrop-blur hover:bg-white/20"><svg width="24" height="24" viewBox="0 0 24 24" fill="white" stroke="none"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg></button>
                                <span class="text-xs font-bold">89K</span>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Mock Bottom Nav -->
                <div class="absolute bottom-0 w-full h-16 bg-black/50 backdrop-blur-md border-t border-white/10 flex justify-around items-center px-4 z-20 rounded-b-[36px]">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="white" stroke="currentColor" stroke-width="2"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                    <div class="w-10 h-8 bg-white text-black flex items-center justify-center rounded-lg font-bold">+</div>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                </div>
            </div>

            <!-- 4. SETTINGS APP -->
            <div id="settings-app" class="glass-panel app-window interactive-element hidden bg-black/40">
                <div class="p-6 overflow-y-auto h-full no-scrollbar">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-bold text-xl tracking-tight">System Settings</h3>
                        <button onclick="toggleApp('settings')" class="text-white/50 hover:text-white">&times;</button>
                    </div>

                    <!-- Customization -->
                    <div class="mb-8">
                        <h4 class="text-xs font-bold uppercase tracking-widest text-white/50 mb-3">Themes</h4>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="updateColor('#6366f1', '#ec4899')" class="p-3 rounded-lg bg-indigo-500/20 border border-indigo-500/50 text-xs font-bold hover:bg-indigo-500/40 transition-colors">VAPOR</button>
                            <button onclick="updateColor('#10b981', '#064e3b')" class="p-3 rounded-lg bg-emerald-500/20 border border-emerald-500/50 text-xs font-bold hover:bg-emerald-500/40 transition-colors">MATRIX</button>
                            <button onclick="updateColor('#f59e0b', '#dc2626')" class="p-3 rounded-lg bg-orange-500/20 border border-orange-500/50 text-xs font-bold hover:bg-orange-500/40 transition-colors">CYBER</button>
                            <button onclick="updateColor('#000000', '#333333')" class="p-3 rounded-lg bg-gray-500/20 border border-gray-500/50 text-xs font-bold hover:bg-gray-500/40 transition-colors">STEALTH</button>
                        </div>
                    </div>

                    <div class="mb-8">
                        <h4 class="text-xs font-bold uppercase tracking-widest text-white/50 mb-3">Physics Engine</h4>
                        <label class="flex justify-between text-sm mb-1"><span>Tilt Intensity</span> <span id="tilt-val">50%</span></label>
                        <input type="range" class="w-full accent-white bg-white/10 rounded-lg appearance-none h-1 mb-4" id="tiltRange" value="50">
                        
                        <label class="flex justify-between text-sm mb-1"><span>Fluid Viscosity</span> <span id="visc-val">50%</span></label>
                        <input type="range" class="w-full accent-white bg-white/10 rounded-lg appearance-none h-1 mb-2" id="viscRange" value="50">
                    </div>

                    <div class="mb-8 p-4 bg-white/5 rounded-xl border border-white/10">
                        <h4 class="text-xs font-bold uppercase tracking-widest text-indigo-300 mb-3">Commands</h4>
                        <ul class="text-xs space-y-2 opacity-80 font-mono">
                            <li class="flex justify-between"><span>Browser</span> <span>Ctrl + B</span></li>
                            <li class="flex justify-between"><span>Code Editor</span> <span>Ctrl + E</span></li>
                            <li class="flex justify-between"><span>Phone / Social</span> <span>Ctrl + M</span></li>
                            <li class="flex justify-between"><span>Settings</span> <span>Ctrl + S</span></li>
                        </ul>
                    </div>

                    <!-- Hardware Stats -->
                    <div>
                        <h4 class="text-xs font-bold uppercase tracking-widest text-white/50 mb-3">Diagnostics</h4>
                        <div class="flex justify-between items-end mb-4">
                            <div>
                                <div class="text-xs opacity-50 mb-1">REAL FPS</div>
                                <div class="text-2xl font-mono" id="fps-counter">0.0</div>
                            </div>
                            <div class="text-right">
                                <div class="text-xs opacity-50 mb-1">RAM ALLOC</div>
                                <div class="text-2xl font-mono" id="ram-counter">2.41GB</div>
                            </div>
                        </div>
                        <div class="w-full h-1 bg-white/10 rounded overflow-hidden">
                            <div class="h-full bg-green-400 rounded transition-all duration-1000" id="ram-bar" style="width: 45%"></div>
                        </div>
                    </div>
                </div>
            </div>

        </main>

        <footer class="taskbar interactive-element">
            <div class="app-icon active" id="btn-browser" onclick="toggleApp('browser')" title="Browser (Ctrl+B)"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg></div>
            <div class="app-icon" id="btn-editor" onclick="toggleApp('editor')" title="Liquid Edit (Ctrl+E)"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg></div>
            <div class="app-icon" id="btn-phone" onclick="toggleApp('phone')" title="Phone / Social (Ctrl+M)"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect><line x1="12" y1="18" x2="12.01" y2="18"></line></svg></div>
            <div class="app-icon" id="btn-settings" onclick="toggleApp('settings')" title="Settings (Ctrl+S)"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg></div>
        </footer>
    </div>

    <script>
        /* --- APP / WINDOW MANAGER LOGIC --- */
        const apps = {
            browser: document.getElementById('browser-app'),
            editor: document.getElementById('editor-app'),
            phone: document.getElementById('phone-app'),
            settings: document.getElementById('settings-app')
        };
        const btns = {
            browser: document.getElementById('btn-browser'),
            editor: document.getElementById('btn-editor'),
            phone: document.getElementById('btn-phone'),
            settings: document.getElementById('btn-settings')
        };

        function toggleApp(appName) {
            const el = apps[appName];
            const btn = btns[appName];
            if (el.classList.contains('hidden')) {
                el.classList.remove('hidden');
                btn.classList.add('active');
                showCommandToast(`Opened ${appName.toUpperCase()}`);
            } else {
                // Prevent closing everything
                const activeCount = Object.values(apps).filter(a => !a.classList.contains('hidden')).length;
                if(activeCount <= 1) return showCommandToast("Cannot close last window");
                
                el.classList.add('hidden');
                btn.classList.remove('active');
                showCommandToast(`Closed ${appName.toUpperCase()}`);
            }
        }

        /* --- COMMAND / SHORTCUT LOGIC --- */
        const toast = document.getElementById('cmd-toast');
        const toastText = document.getElementById('cmd-text');
        let toastTimeout;

        function showCommandToast(msg) {
            toastText.innerText = msg;
            toast.classList.add('show');
            clearTimeout(toastTimeout);
            toastTimeout = setTimeout(() => toast.classList.remove('show'), 2000);
        }

        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey) {
                switch(e.key.toLowerCase()) {
                    case 'b': e.preventDefault(); toggleApp('browser'); break;
                    case 'e': e.preventDefault(); toggleApp('editor'); break;
                    case 'm': e.preventDefault(); toggleApp('phone'); break;
                    case 's': e.preventDefault(); toggleApp('settings'); break;
                }
            }
        });

        /* --- BROWSER ENGINE LOGIC --- */
        let tabs = [{ id: 1, title: 'Liquid Home', url: 'liquid://home' }];
        let activeTabId = 1; let tabCounter = 1;
        const urlInput = document.getElementById('url-input');
        const frame = document.getElementById('browser-frame');
        const homeScreen = document.getElementById('home-screen');
        const tabBar = document.getElementById('tab-bar');

        function renderTabs() {
            tabBar.innerHTML = '';
            tabs.forEach(tab => {
                const tabEl = document.createElement('div');
                tabEl.className = `tab ${tab.id === activeTabId ? 'active' : ''}`;
                tabEl.onclick = () => switchTab(tab.id);
                tabEl.innerHTML = `<span class="truncate overflow-hidden w-full text-left">${tab.title}</span>`;
                const closeBtn = document.createElement('span');
                closeBtn.innerText = '√ó'; closeBtn.className = 'close-btn';
                closeBtn.onclick = (e) => { e.stopPropagation(); closeTab(tab.id); };
                tabEl.appendChild(closeBtn); tabBar.appendChild(tabEl);
            });
            const addBtn = document.createElement('button');
            addBtn.className = 'px-3 opacity-50 hover:opacity-100 text-lg font-bold ml-1';
            addBtn.innerText = '+'; addBtn.onclick = addTab; tabBar.appendChild(addBtn);
        }
        function switchTab(id) { activeTabId = id; const tab = tabs.find(t => t.id === id); if (tab) { renderTabs(); loadUrl(tab.url, false); } }
        function closeTab(id) {
            if (tabs.length === 1) return;
            const index = tabs.findIndex(t => t.id === id);
            tabs = tabs.filter(t => t.id !== id);
            if (activeTabId === id) switchTab((tabs[index - 1] || tabs[0]).id); else renderTabs();
        }
        function addTab() { tabCounter++; const newTab = { id: tabCounter, title: 'New Tab', url: 'liquid://home' }; tabs.push(newTab); switchTab(newTab.id); }
        
        function formatUrl(rawUrl) {
            if (rawUrl === 'liquid://home') return rawUrl;
            if (!rawUrl.startsWith('http')) {
                if (rawUrl.includes('.') && !rawUrl.includes(' ')) return 'https://' + rawUrl;
                return 'https://www.bing.com/search?q=' + encodeURIComponent(rawUrl);
            }
            return rawUrl;
        }

        function loadUrl(rawUrl, updateActiveTabObj = true) {
            const finalUrl = formatUrl(rawUrl);
            urlInput.value = finalUrl;
            if (finalUrl === 'liquid://home') { frame.style.display = 'none'; homeScreen.style.display = 'flex'; } 
            else { homeScreen.style.display = 'none'; frame.style.display = 'block'; if (frame.src !== finalUrl) frame.src = finalUrl; }

            if (updateActiveTabObj) {
                const tab = tabs.find(t => t.id === activeTabId);
                if (tab) {
                    tab.url = finalUrl;
                    try { tab.title = finalUrl === 'liquid://home' ? 'Liquid Home' : new URL(finalUrl).hostname.replace('www.', ''); } 
                    catch { tab.title = rawUrl; }
                }
                renderTabs();
            }
        }
        urlInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') { loadUrl(urlInput.value); urlInput.blur(); } });
        renderTabs();

        /* --- SETTINGS & PHYSICS CONFIG --- */
        let currentVisc = 0.5;
        let currentCol = [0.38, 0.4, 0.94];
        let physicsMultiplier = 0.003;

        document.getElementById('viscRange').oninput = (e) => {
            currentVisc = e.target.value / 100;
            document.getElementById('visc-val').innerText = e.target.value + '%';
        };
        
        document.getElementById('tiltRange').oninput = (e) => {
            // Map 0-100 to 0.000 (flat) to 0.006 (extreme tilt)
            physicsMultiplier = (e.target.value / 100) * 0.006;
            document.getElementById('tilt-val').innerText = e.target.value + '%';
        };

        window.updateColor = (hex1, hex2) => {
            const r = parseInt(hex1.slice(1,3),16)/255, g = parseInt(hex1.slice(3,5),16)/255, b = parseInt(hex1.slice(5,7),16)/255;
            currentCol = [r, g, b];
            document.getElementById('blob1').style.background = hex1;
            document.getElementById('blob2').style.background = hex2;
            showCommandToast("Theme Updated");
        };

        /* --- HARDWARE SIMULATION LOGIC --- */
        let frameCount = 0; let lastFpsTime = performance.now(); let baseRam = 2.4;
        const fpsCounter = document.getElementById('fps-counter'); const ramCounter = document.getElementById('ram-counter'); const ramBar = document.getElementById('ram-bar');
        setInterval(() => {
            let currentRam = baseRam + ((Math.random() - 0.5) * 0.1);
            if(currentRam < 1.0) currentRam = 1.0; if(currentRam > 6.0) currentRam = 6.0;
            ramCounter.innerText = currentRam.toFixed(2) + 'GB';
            const percent = (currentRam / 8.0) * 100; ramBar.style.width = percent + '%';
            if(percent > 70) ramBar.className = "h-full bg-red-400 rounded transition-all duration-1000";
            else if(percent > 40) ramBar.className = "h-full bg-yellow-400 rounded transition-all duration-1000";
            else ramBar.className = "h-full bg-green-400 rounded transition-all duration-1000";
        }, 2000);

        /* --- WEBGL & SHADER LOGIC --- */
        const canvas = document.getElementById('glCanvas'); const gl = canvas.getContext('webgl');
        const vs = `attribute vec4 p; void main() { gl_Position = p; }`;
        const fs = `
            precision highp float; uniform vec2 res; uniform float time; uniform vec2 mouse; uniform vec3 col; uniform float visc;
            float hash(vec2 p) { return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453123); }
            float noise(vec2 p) {
                vec2 i = floor(p); vec2 f = fract(p); f = f*f*(3.0-2.0*f);
                return mix(mix(hash(i + vec2(0,0)), hash(i + vec2(1,0)), f.x), mix(hash(i + vec2(0,1)), hash(i + vec2(1,1)), f.x), f.y);
            }
            void main() {
                vec2 uv = gl_FragCoord.xy / res.xy; vec2 m = mouse / res.xy;
                vec2 p = (uv - 0.5) * vec2(res.x/res.y, 1.0); vec2 mp = (m - 0.5) * vec2(res.x/res.y, 1.0);
                float d = length(p - mp); float ripple = sin(d * 12.0 - time * 1.5) * exp(-d * 4.0);
                vec2 refUv = uv + ripple * 0.08 * visc; refUv.x += noise(p * 4.0 + time * 0.1) * 0.03;
                vec3 base = vec3(0.02, 0.02, 0.04); float glow = smoothstep(0.7, 0.0, d); float spec = pow(max(0.0, 1.0 - length(uv + (p-mp)*0.15 - m)), 20.0);
                vec3 fCol = mix(base, col, glow * 0.6); fCol += vec3(1.0) * spec * 0.5; fCol *= 1.1 - length(uv - 0.5);
                gl_FragColor = vec4(fCol, 1.0);
            }
        `;
        const program = gl.createProgram();
        const s = (t, src) => { const s = gl.createShader(t); gl.shaderSource(s, src); gl.compileShader(s); gl.attachShader(program, s); };
        s(gl.VERTEX_SHADER, vs); s(gl.FRAGMENT_SHADER, fs); gl.linkProgram(program);
        const buf = gl.createBuffer(); gl.bindBuffer(gl.ARRAY_BUFFER, buf);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1,-1, 1,-1, -1,1, 1,1]), gl.STATIC_DRAW);
        const pLoc = gl.getAttribLocation(program, 'p');
        const uniforms = { res: gl.getUniformLocation(program, 'res'), time: gl.getUniformLocation(program, 'time'), mouse: gl.getUniformLocation(program, 'mouse'), col: gl.getUniformLocation(program, 'col'), visc: gl.getUniformLocation(program, 'visc') };

        let mouse = { x: 0, y: 0, tx: 0, ty: 0 };
        window.addEventListener('mousemove', e => { mouse.tx = e.clientX; mouse.ty = window.innerHeight - e.clientY; });

        const elements = document.querySelectorAll('.interactive-element');
        function updatePhysics() {
            elements.forEach(el => {
                const rect = el.getBoundingClientRect();
                if (rect.width === 0) return; // Skip hidden elements
                
                const centerX = rect.left + rect.width / 2; const centerY = rect.top + rect.height / 2;
                const dx = (mouse.tx - centerX) * physicsMultiplier;
                const dy = (window.innerHeight - mouse.ty - centerY) * physicsMultiplier;
                
                el.style.transform = `rotateX(${dy * -0.5}deg) rotateY(${dx * 0.5}deg) translateZ(5px)`;
            });
        }

        function loop(t) {
            frameCount++; if (t - lastFpsTime >= 1000) { fpsCounter.innerText = frameCount.toFixed(1); frameCount = 0; lastFpsTime = t; }
            mouse.x += (mouse.tx - mouse.x) * 0.1; mouse.y += (mouse.ty - mouse.y) * 0.1;
            if (canvas.width !== window.innerWidth || canvas.height !== window.innerHeight) {
                canvas.width = window.innerWidth; canvas.height = window.innerHeight; gl.viewport(0, 0, canvas.width, canvas.height);
            }
            gl.useProgram(program); gl.enableVertexAttribArray(pLoc); gl.vertexAttribPointer(pLoc, 2, gl.FLOAT, false, 0, 0);
            gl.uniform2f(uniforms.res, canvas.width, canvas.height); gl.uniform1f(uniforms.time, t * 0.001);
            gl.uniform2f(uniforms.mouse, mouse.x, mouse.y); gl.uniform3fv(uniforms.col, currentCol); gl.uniform1f(uniforms.visc, currentVisc);
            gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);

            updatePhysics(); requestAnimationFrame(loop);
        }
        requestAnimationFrame(loop);
    </script>
</body>
</html>